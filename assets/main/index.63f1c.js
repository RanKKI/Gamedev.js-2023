window.__require=function e(t,n,o){function r(c,a){if(!n[c]){if(!t[c]){var s=c.split("/");if(s=s[s.length-1],!t[s]){var u="function"==typeof __require&&__require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var l=n[c]={exports:{}};t[c][0].call(l.exports,function(e){return r(t[c][1][e]||e)},l,l.exports,e,t,n,o)}return n[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<o.length;c++)r(o[c]);return r}({Main:[function(e,t,n){"use strict";cc._RF.push(t,"27ce8S4IPNMBLINswmKXlTv","Main");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},c=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),e("cc");var s=e("./manager/ui-manager"),u=e("./user/userdata"),l=cc._decorator,f=l.ccclass,p=l.menu,h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.start=function(){return c(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return console.log("Main start"),[4,this.loadUserData()];case 1:return e.sent(),[4,s.UI.openLayer("prefab/layers/GameLayer",null)];case 2:return e.sent(),[2]}})})},t.prototype.loadUserData=function(){return c(this,void 0,void 0,function(){return a(this,function(){return console.log("load user data"),u.userData.load(),console.debug("load debug data"),u.userData.loadDebug(),console.log("finish load user data"),[2]})})},i([f,p("components/Main")],t)}(cc.Component);n.default=h,cc._RF.pop()},{"./manager/ui-manager":"ui-manager","./user/userdata":"userdata",cc:void 0}],"base-layer":[function(e,t,n){"use strict";cc._RF.push(t,"6e5ecjPvvxFMY09MKOcAVES","base-layer");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},c=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("../../common"),u=cc._decorator.ccclass,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="",t}return r(t,e),t.prototype.init=function(e){this.options=e},t.prototype.preLoad=function(){return c(this,void 0,void 0,function(){return a(this,function(){return[2]})})},t.prototype.show=function(){this.onShow()},t.prototype.onShow=function(){},t.prototype.hide=function(){this.onHide()},t.prototype.onHide=function(){},t.prototype.close=function(){var e=this.node;e.emit(s.Event.BEFORE_NODE_REMOVE,e),e.active=!1,e.removeFromParent(),e.emit(s.Event.ON_NODE_REMOVE,e),e.parent=null},i([u],t)}(cc.Component);n.default=l,cc._RF.pop()},{"../../common":"index"}],"base-panel":[function(e,t,n){"use strict";cc._RF.push(t,"ad874a95yhBy6VubdYIWjDH","base-panel");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=e("../../common/common"),a=cc._decorator,s=a.ccclass,u=a.property,l=a.disallowMultiple,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.animDuration=.5,t.finishCallback=null,t.returnValue=null,t}return r(t,e),t.prototype.show=function(e,t){void 0===t&&(t=this.animDuration),this.options=e,this.playEnterAnima(t),this.init(this.options),this.updateDisplay(this.options)},t.prototype.playEnterAnima=function(e){var t=this,n=this.content;this.node.active=!0,n.active=!0,n.scale=.5,n.opacity=0,cc.tween(n).to(e,{scale:1,opacity:255},{easing:"backOut"}).call(function(){t.onShow&&t.onShow()}).start()},t.prototype.hide=function(e){var t=this;c.tempDisableButton(e,1),c.disableTouch(this.node,!0);var n=this.node,o=cc.tween(this.content).to(.125,{scale:1.1},{easing:cc.easing.quadOut}).parallel(cc.tween(this.content).to(.25,{scale:.5},{easing:cc.easing.quadIn}),cc.tween(this.content).delay(1/24).to(.25,{opacity:0})).call(function(){n.active=!1,t.onHide&&t.onHide(),c.disableTouch(t.node,!1),t.finishCallback&&t.finishCallback(n,t.returnValue)});return new Promise(function(e){o.call(function(){e()}).start()})},t.prototype.init=function(){},t.prototype.updateDisplay=function(){},t.prototype.onShow=function(){},t.prototype.onHide=function(){},t.prototype.setFinishCallback=function(e){this.finishCallback=e},t.prototype.setReturnValue=function(e){this.returnValue=e},i([u(cc.Node)],t.prototype,"content",void 0),i([s,l],t)}(cc.Component);n.default=f,cc._RF.pop()},{"../../common/common":"common"}],"card-data-type":[function(e,t){"use strict";cc._RF.push(t,"7d89fKaOzlJFZ4px5FMbFdm","card-data-type"),cc._RF.pop()},{}],"card-deck":[function(e,t,n){"use strict";cc._RF.push(t,"66db1/pPZtAXp/6n44p2OY3","card-deck");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},c=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.CardDeckComponent=n.CardDeckMode=void 0,e("cc");var s,u=e("./card"),l=e("../common/object-pool"),f=e("../common"),p=e("../common/event/events"),h=e("../manager/ui-manager"),d=cc._decorator,y=d.ccclass,v=d.property,b=d.menu;(function(e){e[e.Player=0]="Player",e[e.Computer=1]="Computer"})(s=n.CardDeckMode||(n.CardDeckMode={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.deck=null,t.cards=[],t.mode=null,t.selectedCard=null,t}return r(t,e),t.prototype.setMode=function(e){this.mode!==e&&(this.mode=e,this.removeTouchListener(),e===s.Player&&this.addTouchListener(),this.createCard())},t.prototype.start=function(){console.log("CardDeckComponent start")},t.prototype.createCard=function(){return c(this,void 0,void 0,function(){var e,t,n;return a(this,function(o){switch(o.label){case 0:e=0,o.label=1;case 1:return e<7?[4,l.objectPool.cardPool.get()]:[3,4];case 2:t=o.sent(),this.deck.addChild(t),(n=t.getComponent(u.CardComponent)).setIsVisible(this.mode===s.Player),this.cards.push(n),o.label=3;case 3:return e++,[3,1];case 4:return this.reorderCard(!1),[2]}})})},t.prototype.reorderCard=function(e){return void 0===e&&(e=!0),c(this,void 0,void 0,function(){var t,n,o,r,i;return a(this,function(c){switch(c.label){case 0:for(t=[],n=Math.floor(this.cards.length/2),o=function(o){var i=r.cards[o],c=o<n?15*(n-o):o>n?-15*(o-n):0;e?t.push(new Promise(function(e){cc.tween(i.node).to(.2,{angle:c}).call(function(){e()}).start()})):i.node.angle=c},r=this,i=0;i<this.cards.length;i++)o(i);return[4,Promise.all(t)];case 1:return c.sent(),[2]}})})},t.prototype.addTouchListener=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_START)||(this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegin,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this))},t.prototype.removeTouchListener=function(){this.node.hasEventListener(cc.Node.EventType.TOUCH_START)&&(this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegin,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this))},t.prototype.onTouchBegin=function(e){var t,n=e.getLocation();cc.Camera.main.getScreenToWorldPoint(n,n),this.node.convertToNodeSpaceAR(n,n);for(var o=this.cards.length-1;o>=0&&!(t=this.cards[o]).hitTest(e);o--);t?(console.log("card touched",t.node),this.selectedCard=t,t.setSelect(!0),t.beforeMoving(),t.setMoving(e)):console.log("no card touched")},t.prototype.onTouchMove=function(e){this.selectedCard&&this.selectedCard.updateMoving(e)},t.prototype.isOnTable=function(e){var t=e.node.getPosition();return e.node.convertToWorldSpaceAR(t,t),this.node.parent.convertToNodeSpaceAR(t,t),this.node.getBoundingBox().contains(t)},t.prototype.onTouchEnd=function(){var e=this.selectedCard;if(this.selectedCard=null,e){var t=!this.isOnTable(e);e.setSelect(!1),t||e.afterMoving(!0),t&&(this.useCard(e),p.gameEvent.emit({name:p.GameEvent.UserRoundFinished,data:{card:e}}))}},t.prototype.useCard=function(e){this.cards.splice(this.cards.indexOf(e),1),this.reorderCard(),cc.tween(e.node).to(.2,{opacity:0}).call(function(){e.node.parent=null,l.objectPool.cardPool.put(e.node)}).start()},t.prototype.play=function(){return c(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return this.mode===s.Player?[2]:(e=f.randomChoiceOne(this.cards),t=cc.v2(0,50),h.UI.getTopLayer().node.convertToWorldSpaceAR(t,t),e.node.parent.convertToNodeSpaceAR(t,t),console.log("centerPos",t),e.beforeMoving(),e.setMoving(),e.setIsVisible(!0),[4,new Promise(function(n){cc.tween(e.node).to(1,{x:t.x,y:t.y},{easing:cc.easing.sineIn}).call(function(){n()}).start()})]);case 1:return n.sent(),this.useCard(e),[2]}})})},i([v(cc.Node)],t.prototype,"deck",void 0),i([y,b("components/CardDeck")],t)}(cc.Component);n.CardDeckComponent=g,cc._RF.pop()},{"../common":"index","../common/event/events":"events","../common/object-pool":"object-pool","../manager/ui-manager":"ui-manager","./card":"card",cc:void 0}],"card-manager":[function(e,t,n){"use strict";cc._RF.push(t,"554f8t/sZ5JTr/VIAzTNVaA","card-manager");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.cardManager=void 0;var i=e("../manager/resources"),c=function(){function e(){}return e.prototype.loadJSONConfig=function(e){return o(this,void 0,void 0,function(){return r(this,function(){return[2,i.loadLocalRes("configs/"+e)]})})},e.prototype.validateCards=function(){return o(this,void 0,void 0,function(){var e,t;return r(this,function(){if(e=this.cardConfig.map(function(e){return e.id}),t=new Set(e),e.length!==t.size)throw new Error("duplicate card id");return[2]})})},e.prototype.loadConfigs=function(){return o(this,void 0,void 0,function(){return r(this,function(){return[2]})})},e}();n.cardManager=new c,cc._RF.pop()},{"../manager/resources":"resources"}],card:[function(e,t,n){"use strict";cc._RF.push(t,"3362fug6qFPhrfwILAXG8W0","card");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0}),n.CardComponent=void 0,e("cc");var c=cc._decorator,a=c.ccclass,s=c.property,u=c.menu,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cardNode=null,t.cardBg=null,t.selected=null,t.collider=null,t.isVisible=!1,t.bSelected=!1,t.currentAngle=0,t.currentPos=null,t.currentZIndex=0,t}return r(t,e),t.prototype.start=function(){this.setIsVisible(this.isVisible),this.setSelect(this.bSelected)},t.prototype.setIsVisible=function(e){this.cardNode.active=e,this.cardBg.active=!e,this.isVisible=e},t.prototype.hitTest=function(e){var t=e.getLocation();return cc.Camera.main.getScreenToWorldPoint(t,t),this.node.convertToNodeSpaceAR(t,t),cc.Intersection.pointInPolygon(t,this.collider.points)},t.prototype.beforeMoving=function(){this.currentAngle=this.node.angle,this.currentPos=this.node.position.clone(),this.currentZIndex=this.node.getSiblingIndex()},t.prototype.setSelect=function(e){this.selected.active=e,this.bSelected=e},t.prototype.setMoving=function(e){void 0===e&&(e=null),this.node.angle=0,this.node.setSiblingIndex(this.node.parent.childrenCount-1),e&&this.updateMoving(e)},t.prototype.getScaledHeight=function(){return this.node.height*this.node.scaleY},t.prototype.updateMoving=function(e){var t=e.getLocation();cc.Camera.main.getScreenToWorldPoint(t,t),this.node.parent.convertToNodeSpaceAR(t,t),this.node.setPosition(t.add(cc.v2(0,-this.getScaledHeight()/2)))},t.prototype.afterMoving=function(e){e&&(this.node.angle=this.currentAngle,this.node.position=this.currentPos,this.node.setSiblingIndex(this.currentZIndex))},i([s(cc.Node)],t.prototype,"cardNode",void 0),i([s(cc.Node)],t.prototype,"cardBg",void 0),i([s(cc.Node)],t.prototype,"selected",void 0),i([s(cc.PolygonCollider)],t.prototype,"collider",void 0),i([a,u("components/Card")],t)}(cc.Component);n.CardComponent=l,cc._RF.pop()},{cc:void 0}],common:[function(e,t,n){"use strict";cc._RF.push(t,"bdd80aPButDZpSjcYdhHeUq","common");var o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],c=0,a=i.length;c<a;c++,r++)o[r]=i[c];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.isPord=n.mapRange=n.clamp=n.deepClone=n.mergeDeep=n.isObject=n.randomChoice=n.randomChoiceOne=n.shuffleArr=n.sleep=n.compareVersion=n.random=n.randomInt=n.disableTouch=n.tempDisableButton=n.disableBtn=n.resetGlobalBlockInputComp=n.disableAllTouch=n.showNode=n.toThousands=n.curCanvas=n.getScreenHeight=n.getScreenWidth=void 0,n.getScreenWidth=function(){return cc.view.getCanvasSize().width},n.getScreenHeight=function(){return cc.view.getCanvasSize().height},n.curCanvas=function(){var e=cc.director.getScene();return cc.find("Canvas",e)},n.toThousands=function(e){return void 0===e&&(e=0),e.toString().replace(/\d+/,function(e){return e.replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")})},n.showNode=function(e,t,n,o){void 0===o&&(o=0),n&&(e.scale=0,cc.tween(e).delay(o).to(n,{scale:1}).start()),null!=e&&(e.active=t)};var r=null;function i(e,t){e.interactable=!t}function c(e){for(var t=e.length-1;t>=0;t--){var n=Math.floor(Math.random()*(t+1)),o=e[n];e[n]=e[t],e[t]=o}return e}function a(e,t){return c(Object.assign([],e)).slice(0,t)}function s(e){return e&&"object"==typeof e&&!Array.isArray(e)}function u(e,t,n){return e<t?t:e>n?n:e}n.disableAllTouch=function(e){if(null==r){var t=cc.director.getScene().getComponentInChildren(cc.Canvas).node.children,n=t[t.length-1];r=n.getComponent(cc.BlockInputEvents)}r&&(r.enabled=e)},n.resetGlobalBlockInputComp=function(){r=null},n.disableBtn=i,n.tempDisableButton=function(e,t){if(void 0===t&&(t=0),null!=e){e instanceof cc.Event.EventTouch&&(e=e.target);var n=null;if(e instanceof cc.Button?n=e:e instanceof cc.Node&&(n=e.getComponent(cc.Button)),null!=n){var o=function(){i(n,!1)};return i(n,!0),n.scheduleOnce(o,t),function(){o(),n.unschedule(o)}}}},n.disableTouch=function(e,t){t?e.pauseSystemEvents(!0):e.resumeSystemEvents(!0)},n.randomInt=function(e,t){return Math.floor(Math.random()*(t-e))+e},n.random=function(e,t){return Math.random()*(t-e)+e},n.compareVersion=function(e,t){for(var n=e.split("."),o=t.split("."),r=Math.max(n.length,o.length);n.length<r;)n.push("0");for(;o.length<r;)o.push("0");for(var i=0;i<r;i++){var c=parseInt(n[i]),a=parseInt(o[i]);if(c>a)return 1;if(c<a)return-1}return 0},n.sleep=function(e,t){return new Promise(function(n){t?t.scheduleOnce(function(){n()},e):cc.director.getScene().getComponentInChildren(cc.Canvas).scheduleOnce(function(){n()},e)})},n.shuffleArr=c,n.randomChoiceOne=function(e){return a(e,1)[0]},n.randomChoice=a,n.isObject=s,n.mergeDeep=function e(t){for(var n,r,i=[],c=1;c<arguments.length;c++)i[c-1]=arguments[c];if(!i.length)return t;var a=i.shift();if(s(t)&&s(a))for(var u in a)s(a[u])?(t[u]||Object.assign(t,((n={})[u]={},n)),e(t[u],a[u])):Object.assign(t,((r={})[u]=a[u],r));return e.apply(void 0,o([t],i))},n.deepClone=function e(t){var n;if("object"==typeof t)if(Array.isArray(t))for(var o in n=[],t)n.push(e(t[o]));else if(null===t)n=null;else if(t.constructor===RegExp)n=t;else for(var o in n={},t)n[o]=e(t[o]);else n=t;return n},n.clamp=u,n.mapRange=function(e,t,n,o,r){return u((e-t)*(r-o)/(n-t)+o,o,r)},n.isPord=!1,cc._RF.pop()},{}],env:[function(e,t,n){"use strict";var o;cc._RF.push(t,"0ff909GluFHlajfQQM3N0t0","env"),Object.defineProperty(n,"__esModule",{value:!0}),n.env=n.EnvMode=void 0,function(e){e.Debug="Debug",e.TEST="Test",e.PROD="Prod"}(o=n.EnvMode||(n.EnvMode={})),n.env={version:"0.1.1",mode:o.TEST,network:{server:"https://xbtnc-test.hortor003.com",retryT:2,defaultRetryCnt:3,resourceURL:""}},cc._RF.pop()},{}],events:[function(e,t,n){"use strict";cc._RF.push(t,"a793cljNWpNmr4dFxYsHJjr","events"),Object.defineProperty(n,"__esModule",{value:!0}),n.resetAllEvents=n.gameEvent=n.GameEvent=n.logEvent=n.LogLevel=n.ON_NODE_REMOVE=n.BEFORE_NODE_REMOVE=void 0;var o=e("./typed-event");n.BEFORE_NODE_REMOVE="BEFORE_NODE_REMOVE",n.ON_NODE_REMOVE="ON_NODE_REMOVE",n.LogLevel={DEBUG:0,INFO:1,WARN:2,ERROR:3},n.logEvent=new o.TypedEvent,n.GameEvent={UserRoundFinished:"UserRoundFinished"},n.gameEvent=new o.TypedEvent;var r=[n.logEvent];n.logEvent.on(function(e){e.level||n.LogLevel.DEBUG;var t=e.log||"";console.log(t)}),n.resetAllEvents=function(){r.forEach(function(e){e.reset()})},cc._RF.pop()},{"./typed-event":"typed-event"}],"game-layer":[function(e,t,n){"use strict";cc._RF.push(t,"3e88dNKx4VLHJby+XBYQ76X","game-layer");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},c=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),e("cc");var s=e("./manager/ui-manager"),u=e("./components/base/base-layer"),l=e("./components/ext/linked-prefab"),f=e("./components/card-deck"),p=e("./common/event/events"),h=cc._decorator,d=h.ccclass,y=h.menu,v=h.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.playerDeckPrefab=null,t.oppositeDeckPrefab=null,t}return r(t,e),Object.defineProperty(t.prototype,"playerDeck",{get:function(){return this.playerDeckPrefab.getComponent(f.CardDeckComponent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oppositeDeck",{get:function(){return this.oppositeDeckPrefab.getComponent(f.CardDeckComponent)},enumerable:!1,configurable:!0}),t.prototype.testPanel=function(){return c(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return console.log("GameLayer testPanel"),[4,s.UI.openPanel("prefab/common/confirm-panel",null)];case 1:return e.sent(),[2]}})})},t.prototype.start=function(){var e=this;console.log("GameLayer start"),this.playerDeck.setMode(f.CardDeckMode.Player),this.oppositeDeck.setMode(f.CardDeckMode.Computer),p.gameEvent.on(function(t){return e.onGameEvent(t.name,t.data)})},t.prototype.onGameEvent=function(e){e==p.GameEvent.UserRoundFinished&&this.oppositeDeck.play()},i([v(l.default)],t.prototype,"playerDeckPrefab",void 0),i([v(l.default)],t.prototype,"oppositeDeckPrefab",void 0),i([d,y("components/layers/GameLayer")],t)}(u.default);n.default=b,cc._RF.pop()},{"./common/event/events":"events","./components/base/base-layer":"base-layer","./components/card-deck":"card-deck","./components/ext/linked-prefab":"linked-prefab","./manager/ui-manager":"ui-manager",cc:void 0}],http:[function(e,t,n){"use strict";cc._RF.push(t,"0eb6eWvPY5Eea4TnDOpnL2l","http");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.post=n.get=void 0;var i=e("../common"),c=e("../env"),a=e("../toast"),s={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3},u=0,l=function(){return u++};function f(e){return null==e?"":Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t]+"")}).join("&")}function p(e,t){var n=f(t);return n.length>0?e+(-1===e.indexOf("?")?"?":"&")+n:e}function h(e){var t,n={ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText,data:e.responseText};if(n.ok)try{var o=JSON.parse(e.responseText);null!=o.errcode&&o.errcode>0&&(n.ok=!1,n.status=o.errcode,n.statusText=null!==(t=o.errmsg)&&void 0!==t?t:n.statusText),n.data=o.data}catch(r){console.error("failed to parse response text",e.responseText,r)}return n}function d(e,t,n){var o=s.ignoreCache,r=s.headers,i=s.timeout;return new Promise(function(a,s){var u=new XMLHttpRequest,l=p(t,{platform:"default",ver:c.env.version});n&&(l=p(l,n.parameters)),u.open(e,l),r&&Object.keys(r).forEach(function(e){u.setRequestHeader(e,r[e])}),o&&u.setRequestHeader("Cache-Control","no-cache"),u.timeout=i,u.onload=function(){a(h(u))},u.onerror=function(){a(h(u))},u.ontimeout=function(){s(new Error("Time out"))},"post"===e&&n.body?(u.setRequestHeader("Content-Type","application/json"),u.send(JSON.stringify(n.body))):u.send()})}function y(){return o(this,void 0,Promise,function(){return r(this,function(){return[2,!1]})})}function v(e,t,n){var a,s;return o(this,void 0,Promise,function(){var o,u,f,p,h,v,b,g,m;return r(this,function(r){switch(r.label){case 0:(n=null!=n?n:{}).parameters=null!==(a=n.parameters)&&void 0!==a?a:{},n.parameters.consistKey=l(),u=function(){n.silence||(o=setTimeout(function(){},200))},f=function(){null!=o&&clearTimeout(o)},p=null==n.askToRetry||1==n.askToRetry,h=Math.max(1,null!==(s=n.maxAutoRetryCnt)&&void 0!==s?s:c.env.network.defaultRetryCnt),v=0,r.label=1;case 1:if(!(v<h||p))return[3,11];r.label=2;case 2:return r.trys.push([2,4,,10]),u(),[4,d(e,t,n)];case 3:if(b=r.sent(),f(),b.status>=200&&b.status<=399||b.status>=2e4)return[2,b];throw b;case 4:if(g=r.sent(),f(),!n.silence)return[3,6];if(v==h-1)throw g;return[4,i.sleep(.5)];case 5:return r.sent(),[3,9];case 6:return(m=!p)?[3,8]:[4,y()];case 7:m=!r.sent(),r.label=8;case 8:if(m)throw g;r.label=9;case 9:return[3,10];case 10:return v++,[3,1];case 11:return[2]}})})}var b=function(){function e(e){this.method=e,this.queue=[]}return e.prototype.isEmpty=function(){return 0==this.queue.length},e.prototype.push=function(e){e.request=e.request||{};var t=this.isEmpty();this.queue.push(e),t&&this.consume()},e.prototype.clear=function(){for(;!this.isEmpty();)this.queue.pop().onFailed(new Error("the queue of "+this.method+" was cleared"))},e.prototype.handleError=function(e,t){console.log("handle error",t),t instanceof Error?e.onFailed(t):e.onFailed(new Error(t.statusText)),e.request.silence||(t instanceof Error?a.showToast(t.message):t.statusText?a.showToast(t.statusText):a.showToast("\u7f51\u7edc\u8bf7\u6c42\u5931\u8d25"))},e.prototype.consume=function(){return o(this,void 0,void 0,function(){var e,t,n;return r(this,function(o){switch(o.label){case 0:e=this.queue[0],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,v(this.method,c.env.network.server+e.url,e.request)];case 2:return(t=o.sent()).ok?e.onSuccess(t):this.handleError(e,t),[3,4];case 3:return n=o.sent(),this.handleError(e,n),[3,4];case 4:return this.queue.shift(),this.isEmpty()||this.consume(),[2]}})})},e}(),g=new b("get"),m=new b("post");n.get=function(e,t){return o(this,void 0,Promise,function(){return r(this,function(){return[2,new Promise(function(n,o){g.push({request:t,url:e,onSuccess:function(e){n(e)},onFailed:function(e){o(e)}})})]})})},n.post=function(e,t){return o(this,void 0,Promise,function(){return r(this,function(){return[2,new Promise(function(n,o){m.push({url:e,request:t,onSuccess:function(e){n(e)},onFailed:function(e){o(e)}})})]})})},cc._RF.pop()},{"../common":"common","../env":"env","../toast":"toast"}],index:[function(e,t,n){"use strict";cc._RF.push(t,"a5207Jww3lAFYfn0QwbFaVc","index");var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.Event=n.ResUtil=n.HTTP=n.showToast=void 0;var i=e("./event/events");n.Event=i;var c=e("./network/http");n.HTTP=c;var a=e("./resources");n.ResUtil=a,r(e("./common"),n);var s=e("./toast");Object.defineProperty(n,"showToast",{enumerable:!0,get:function(){return s.showToast}}),cc._RF.pop()},{"./common":"common","./event/events":"events","./network/http":"http","./resources":void 0,"./toast":"toast"}],"layer-manager":[function(e,t,n){"use strict";cc._RF.push(t,"a30fckNP/NPvJ7CbGTe2Vww","layer-manager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},c=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.layerEvent=n.LayerManager=void 0;var s=e("../common"),u=e("../common/event/typed-event"),l=e("../common/locker"),f=e("../components/base/base-layer"),p=cc._decorator,h=p.ccclass,d=p.property,y=p.menu,v=p.disallowMultiple,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.container=null,t.currentLayer=null,t.swiftAnimaCount=0,t.isSwitching=!1,t}var o;return r(t,e),o=t,Object.defineProperty(t,"ins",{get:function(){var e=cc.director.getScene().getChildByName("Canvas");return e.getComponent(o)||e.getComponentInChildren(o)},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.layers=[]},t.prototype.beforeSwitch=function(){return c(this,void 0,void 0,function(){return a(this,function(){return this.isSwitching?[2]:(this.isSwitching=!0,[2])})})},t.prototype.afterSwitch=function(){return c(this,void 0,void 0,function(){return a(this,function(){return this.isSwitching=!1,[2]})})},t.prototype.open=function(e,t){return c(this,void 0,Promise,function(){var o,r,i,u,l,p,h=this;return a(this,function(d){switch(d.label){case 0:return o=!1,this.swiftAnimaCount>0?(o=!0,[4,this.beforeSwitch()]):[3,2];case 1:d.sent(),d.label=2;case 2:return this.swiftAnimaCount++,[4,new Promise(function(t,n){cc.resources.load(e,cc.Prefab,function(e,o){e?n(e):t(o)})})];case 3:return r=d.sent(),cc.isValid(r)?(i=cc.instantiate(r),(u=i.getComponent(f.default))?(u.init(t),null!=(l=this.currentLayer)&&(l.getComponent(f.default).hide(),l.active=!1),(p=i.getComponent(cc.Widget))||(p=i.addComponent(cc.Widget)),p.isAlignHorizontalCenter=p.isAlignVerticalCenter=!1,p.isAlignRight=p.isAlignLeft=p.isAlignTop=p.isAlignBottom=!0,p.left=p.right=p.top=p.bottom=0,i.setParent(this.container),i.setSiblingIndex(this.container.childrenCount),[4,u.preLoad()]):(console.error("not found BaseLayer",e),[2,!1])):(console.warn("invalid prefab",e),[2,!1]);case 4:return d.sent(),o?[4,this.afterSwitch()]:[3,6];case 5:d.sent(),d.label=6;case 6:return u.show(),this.currentLayer=i,this.layers.push(i),n.layerEvent.emit({comp:u}),i.once(s.Event.BEFORE_NODE_REMOVE,function(e){return c(h,void 0,void 0,function(){var t,o,r,i,c;return a(this,function(a){switch(a.label){case 0:return[4,this.beforeSwitch()];case 1:return a.sent(),t=this.layers,-1==(o=t.findIndex(function(t){return t==e}))?[2]:(t.splice(o,1),0==(r=t.length)?(this.onNoLayerExists(),[2]):(i=t[r-1],c=i.getComponent(f.default),i.active||(i.active=!0,c.show()),n.layerEvent.emit({comp:c}),this.currentLayer=i,[4,this.afterSwitch()]));case 2:return a.sent(),[2]}})})}),[2]}})})},t.prototype.onNoLayerExists=function(){},i([d(cc.Node)],t.prototype,"container",void 0),i([l.touchLocker],t.prototype,"beforeSwitch",null),i([l.touchLocker],t.prototype,"afterSwitch",null),o=i([h,y("manager/layer-manager"),v],t)}(cc.Component);n.LayerManager=b,n.layerEvent=new u.TypedEvent,cc._RF.pop()},{"../common":"index","../common/event/typed-event":"typed-event","../common/locker":"locker","../components/base/base-layer":"base-layer"}],"linked-prefab":[function(e,t,n){"use strict";cc._RF.push(t,"5c4ba3tEg5PXpleEwDuudko","linked-prefab");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.executeInEditMode,u=c.property,l=c.menu,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._prefab=null,t._prefabNode=null,t}return r(t,e),Object.defineProperty(t.prototype,"prefab",{get:function(){return this._prefab},set:function(e){this._onPrefabChanged(this._prefab,e)},enumerable:!1,configurable:!0}),t.prototype._onPrefabChanged=function(e,t){if(e!=t&&(this._prefab=t,t)){var n=cc.instantiate(t);this._prefabNode=n,n&&(n._objFlags|=cc.Object.Flags.DontSave|cc.Object.Flags.LockedInEditor|cc.Object.Flags.HideInHierarchy,this.node.addChild(n,-1),this.node.width=n.width,this.node.height=n.height)}},t.prototype.onLoad=function(){this._onPrefabChanged(null,this._prefab)},t.prototype.getComponent=function(e){return this._prefabNode.getComponent(e)},i([u],t.prototype,"_prefab",void 0),i([u({type:cc.Prefab,visible:!0})],t.prototype,"prefab",null),i([a,s,l("ext/linked-prefab")],t)}(cc.Component);n.default=f,cc._RF.pop()},{}],locker:[function(e,t,n){"use strict";cc._RF.push(t,"37834vilIBCmow+NMCOxuNL","locker");var o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],c=0,a=i.length;c<a;c++,r++)o[r]=i[c];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.onSceneChanged=n.touchLocker=n.disableTouch=n.isTouchLocked=n.unstashLocker=n.stashLocker=void 0;var r=e("./common");function i(e,t,n){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];t&&t.call.apply(t,o([e],r)),n&&n()}}var c=new Set,a=[];c.add=i(c,c.add,function(){s()}),c.delete=i(c,c.delete,function(){s()});var s=function(){var e=n.isTouchLocked();r.disableAllTouch(e)},u=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^r.randomInt(0,1e12)&15>>e/4).toString(16)})};function l(e){c.delete(e),a.forEach(function(t){t.delete(e)})}n.stashLocker=function(){a.push(new Set(c)),c.clear(),s()},n.unstashLocker=function(){c.clear(),a.length>0&&a.pop().forEach(function(e){c.add(e)}),s()},n.isTouchLocked=function(){return c.size>0},n.disableTouch=function(){var e=u();return c.add(e),function(){c.delete(e)}},n.touchLocker=function(e,t,n){var r=n.value;n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=u();c.add(n);var a=r.call.apply(r,o([this],e));return a instanceof Promise?a.then(function(){l(n)}):l(n),this instanceof cc.Component&&(this.onDestroy=i(this,this.onDestroy,function(){l(n)})),a}},n.onSceneChanged=function(){r.resetGlobalBlockInputComp()},cc._RF.pop()},{"./common":"common"}],"object-pool":[function(e,t,n){"use strict";cc._RF.push(t,"591a5VZwTNFBI66zfx+X1jj","object-pool");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.objectPool=void 0;var i=e("../manager/resources"),c=function(){function e(e){this._pool=[],this._factory=e}return e.prototype.get=function(){return o(this,void 0,void 0,function(){var e;return r(this,function(t){switch(t.label){case 0:return this._pool.length>0?[2,this._pool.pop()]:(e=this._factory())instanceof Promise?[4,e]:[3,2];case 1:return[2,t.sent()];case 2:return[2,e]}})})},e.prototype.put=function(e){this._pool.push(e)},e}();n.objectPool={cardPool:new c(function(){return o(void 0,void 0,void 0,function(){var e;return r(this,function(t){switch(t.label){case 0:return[4,i.loadPrefab("prefab/components/Card")];case 1:return e=t.sent(),[2,cc.instantiate(e)]}})})})},cc._RF.pop()},{"../manager/resources":"resources"}],"panel-manager":[function(e,t,n){"use strict";cc._RF.push(t,"90028WwXTlFYYSQWtS3lhV5","panel-manager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},c=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.PanelManager=n.PanelShowResult=void 0;var s,u=e("../common/locker"),l=e("../components/base/base-panel"),f=e("./layer-manager"),p=cc._decorator,h=p.ccclass,d=p.property,y=p.menu,v=p.disallowMultiple;(function(e){e[e.DONE=0]="DONE",e[e.FAILED=1]="FAILED",e[e.WAITING=2]="WAITING"})(s=n.PanelShowResult||(n.PanelShowResult={}));var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.container=null,t.mask=null,t}var n;return r(t,e),n=t,Object.defineProperty(t,"ins",{get:function(){var e=cc.director.getScene().getChildByName("Canvas");return e.getComponent(n)||e.getComponentInChildren(n)},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){this.panelQueue=[],this.panelList=[],this.mask.active=!1},t.prototype.open=function(e,t,n){return c(this,void 0,Promise,function(){var o,r,i,c,p=this;return a(this,function(a){switch(a.label){case 0:return(n=null!=n?n:{}).inQueue&&this.panelQueue.length>0?(this.panelQueue.push({prefab:e,data:t,opt:n}),[2,{panelResult:s.WAITING}]):[4,new Promise(function(t,n){cc.resources.load(e,cc.Prefab,function(e,o){e?n(e):t(o)})})];case 1:return o=a.sent(),cc.isValid(o)?(r=cc.instantiate(o),(i=r.getComponent(l.default))?((c=r.getComponent(cc.Widget))||(c=r.addComponent(cc.Widget)),c.isAlignTop=c.isAlignBottom=c.isAlignLeft=c.isAlignRight=!0,c.top=c.bottom=c.left=c.right=0,c.alignMode=cc.Widget.AlignMode.ON_WINDOW_RESIZE,this.currentPanel=r,this.panelList.push({prefab:e,data:t,opt:n,node:r}),r.setParent(this.container),i.show(t),this.ensureMask(),console.log("open panel",e),console.log("panel list",this.panelList),console.log("parent",r.parent.name),f.layerEvent.emit({comp:i}),u.stashLocker(),[2,new Promise(function(e){i.setFinishCallback(function(t,n){p.currentPanel=null,t.parent=null,p.panelList.pop(),e({panelResult:s.DONE,values:n}),u.unstashLocker(),p.onNext(),p.scheduleOnce(function(){p.ensureMask(),f.layerEvent.emit({comp:null})},0)})})]):(console.warn("failed to load component of prefab",e),[2,{panelResult:s.FAILED}])):(console.warn("invalid prefab",e),[2,{panelResult:s.FAILED}])}})})},t.prototype.onNext=function(){if(null==this.currentPanel&&0!=this.panelQueue.length){var e=this.panelQueue.shift();this.open(e.prefab,e.data,e.opt)}},t.prototype.ensureMask=function(){var e=this.panelList,t=e.length,n=this.container.childrenCount,o=this.mask;if(t<=0)o.active=!1;else{var r=e[t-1].node;o.active=!0,r.active=!0,o.setSiblingIndex(n),r.setSiblingIndex(n)}},t.prototype.onMaskClick=function(){var e=this.panelList,t=e.length;if(!(t<=0)){var n=e[t-1],o=n.opt,r=n.node;o.clickMaskToClose&&r.getComponent(l.default).hide()}},i([d(cc.Node)],t.prototype,"container",void 0),i([d(cc.Node)],t.prototype,"mask",void 0),n=i([h,y("manager/panel-manager"),v],t)}(cc.Component);n.PanelManager=b,cc._RF.pop()},{"../common/locker":"locker","../components/base/base-panel":"base-panel","./layer-manager":"layer-manager"}],prefab:[function(e,t,n){"use strict";cc._RF.push(t,"45ab66RnohAYLtugJhqcuLB","prefab"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],resources:[function(e,t,n){"use strict";cc._RF.push(t,"88e87O9b1JAjrnunRmE3z8w","resources");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.getResFromBundle=n.loadRes=n.loadRemote=n.loadLocalRes=n.loadAnimaClip=n.preloadPrefab=n.loadPrefab=void 0;var i=e("../common/env");function c(e,t){return o(this,void 0,Promise,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return e?(n=cc.resources,[4,a("resources",e,t)]):[2];case 1:return(o=r.sent())?[2,o]:[2,new Promise(function(o,r){n.load(e,t,function(e,t){e?r(e):o(t)})})]}})})}function a(e,t,n){return o(this,void 0,Promise,function(){var o,i;return r(this,function(){return t&&(o=s(e,t,n))&&(i=cc.assetManager.assets.get(o))?[2,i]:[2,null]})})}function s(e,t,n){var o=cc.assetManager.bundles,r=function(e){if(!o.has(e))return null;var i=o.get(e).getInfoWithPath(t,n);return i?i.redirect?r(i.redirect):i.uuid:null};return r(e)}n.loadPrefab=function(e){return o(this,void 0,Promise,function(){return r(this,function(t){switch(t.label){case 0:return[4,c(e,cc.Prefab)];case 1:return[2,t.sent()]}})})},n.preloadPrefab=function(e){return o(this,void 0,Promise,function(){return r(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){cc.resources.preload(e,cc.Prefab,function(){t()})})];case 1:return t.sent(),[2]}})})},n.loadAnimaClip=function(e){return o(this,void 0,Promise,function(){return r(this,function(t){switch(t.label){case 0:return[4,c(e,cc.AnimationClip)];case 1:return[2,t.sent()]}})})},n.loadLocalRes=function(e){return c(e,cc.Asset)},n.loadRemote=function(e){return o(this,void 0,Promise,function(){return r(this,function(){return e?[2,new Promise(function(t,n){cc.assetManager.loadRemote(i.env.network.resourceURL+e,function(e,o){e?n(e):t(o)})})]:[2]})})},n.loadRes=c,n.getResFromBundle=a,cc._RF.pop()},{"../common/env":"env"}],router:[function(e,t,n){"use strict";cc._RF.push(t,"64ea7SsIWpGALStna0baNNE","router"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],sound:[function(e,t,n){"use strict";cc._RF.push(t,"1738bb0rj9PW4sQR3SWMTRI","sound");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.sound=n.Sound=void 0;var i,c=e("../user/userdata");(function(e){e.COMMON="sound/common",e.BGM="sound/bgm"})(i=n.Sound||(n.Sound={}));var a=function(){function e(){this.isSharing=!1,this.isHiding=!1,this.delayKey=0,this.clips={}}return e.prototype.onSoundChange=function(){var e=this;clearTimeout(this.delayKey),this.delayKey=setTimeout(function(){clearTimeout(e.delayKey),e.delayKey=0,e.isSharing||e.isHiding?e.stopAll():e.resumeAll()},100)},e.prototype.resumeAll=function(){cc.audioEngine.resumeMusic(),cc.audioEngine.resumeAllEffects(),this.onBGMSwitchChange()},e.prototype.stopAll=function(){cc.audioEngine.stopMusic(),cc.audioEngine.stopAllEffects()},e.prototype.play=function(e,t){return void 0===t&&(t=1),o(this,void 0,void 0,function(){var n;return r(this,function(o){switch(o.label){case 0:return!1===c.userData.setting.getValue("bgm")?[2]:(t=Math.min(1,Math.max(0,t)),e instanceof cc.AudioClip?(n=e,[3,4]):[3,1]);case 1:return null==this.clips[e]?[3,2]:(n=this.clips[e],[3,4]);case 2:return[4,new Promise(function(t){cc.resources.load(e,cc.AudioClip,function(e,n){t(e?null:n)})})];case 3:n=o.sent(),this.clips[e]=n,o.label=4;case 4:return n?(cc.audioEngine.playEffect(n,!1),cc.audioEngine.setEffectsVolume(t),[2]):[2]}})})},e.prototype.playBGM=function(){return o(this,void 0,void 0,function(){var e;return r(this,function(t){switch(t.label){case 0:return c.userData.setting.getValue("bgm")?(this.bgmID=0,[4,new Promise(function(e){cc.resources.load(i.BGM,cc.AudioClip,function(t,n){e(t?null:n)})})]):[2];case 1:return e=t.sent(),this.bgmID=cc.audioEngine.playMusic(e,!0),cc.audioEngine.setMusicVolume(.5),[2]}})})},e.prototype.onBGMSwitchChange=function(){var e=cc.audioEngine.getState(this.bgmID)!=cc.audioEngine.AudioState.ERROR;c.userData.setting.getValue("bgm")?e?cc.audioEngine.resumeMusic():this.playBGM():e&&cc.audioEngine.stopMusic()},e}();n.sound=new a,window.sound=n.sound,cc._RF.pop()},{"../user/userdata":"userdata"}],time:[function(e,t,n){"use strict";cc._RF.push(t,"2e98btN7bdEioEXk8VfzlyP","time"),Object.defineProperty(n,"__esModule",{value:!0}),n.formatTimeString=n.time=n.timeEvent=n.getFullDisplayDateTime=n.getFullDisplayTime=n.getFullDisplayDate=n.addZero=n.isToday=n.isSameDay=void 0;var o=e("./event/typed-event"),r=function(){function e(){this.weekDay=-1,this._cachedZoneOffset=null,this.dayChangeT=-1,this.initd=!1}return e.prototype.sync=function(e){var t,n;null!=e&&null!=e.serverTime?(this.serverStartT=1e3*e.serverTime,this.clientStartT=Date.now(),this.weekDay=null!==(t=e.weekDay)&&void 0!==t?t:-1,this.dayChangeT=null!==(n=e.dayChangeT)&&void 0!==n?n:-1):console.warn("invalid server time")},Object.defineProperty(e.prototype,"serverTime",{get:function(){var e=Math.floor((this.serverStartT+Date.now()-this.clientStartT)/1e3);if(isNaN(e))return Math.floor(Date.now()/1e3)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeZoneOffset",{get:function(){if(null==this._cachedZoneOffset){var e=new Date,t=Math.round(e.getTimezoneOffset()/6);this._cachedZoneOffset=-t/10}return this._cachedZoneOffset},enumerable:!1,configurable:!0}),e.prototype.startGlobalTimer=function(e){var t=this;e.schedule(function(e){var o=n.time.serverTime,r=o>t.dayChangeT&&t.dayChangeT>0;r&&(t.dayChangeT+=93600),n.timeEvent.emit({now:o,dt:e,dayChange:r})},1,cc.macro.REPEAT_FOREVER)},e}();function i(e,t){var n=new Date(1e3*e),o=new Date(1e3*t);return n.getFullYear()==o.getFullYear()&&n.getMonth()==o.getMonth()&&n.getDate()==o.getDate()}function c(e){return e<10?"0"+e:e+""}function a(e){var t=new Date(1e3*e);return t.getFullYear()+"/"+c(t.getMonth()+1)+"/"+c(t.getDate())}function s(e){var t=new Date(1e3*e);return c(t.getHours())+":"+c(t.getMinutes())+":"+c(t.getSeconds())}n.isSameDay=i,n.isToday=function(e){return i(n.time.serverTime,e)},n.addZero=c,n.getFullDisplayDate=a,n.getFullDisplayTime=s,n.getFullDisplayDateTime=function(e){return a(e)+" "+s(e)},n.timeEvent=new o.TypedEvent,n.time=new r,window.time=n.time,n.formatTimeString=function(e,t){if(e<=0)return t?"00:00:00":"00:00";var n=e%60,o=(e=(e-n)/60)%60,r=(e-o)/60,i="";return(r>0||t)&&(r<10&&(r="0"+r),i+=r+":"),o<10&&(o="0"+o),n<10&&(n="0"+n),(i+=o+":")+n},cc._RF.pop()},{"./event/typed-event":"typed-event"}],toast:[function(e,t,n){"use strict";cc._RF.push(t,"e014bmTxNhIlpPak2KPWnDC","toast");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.showToast=void 0;var i=e("../manager/resources");n.showToast=function(e,t){return void 0===t&&(t=3e3),o(this,void 0,void 0,function(){var n,o,c,a,s,u,l,f,p,h,d;return r(this,function(r){switch(r.label){case 0:return null==e||""==e?[2]:(n=cc.director.getScene().getComponentInChildren(cc.Canvas),(o=n.node.getChildByName("Toast"))&&o.destroy(),[4,i.loadLocalRes("ui/guide/common_txt_bg")]);case 1:return c=r.sent(),(a=new cc.Node("Toast")).opacity=0,s=new cc.Node("LabelNode"),(u=s.addComponent(cc.Label)).enableBold=!0,u.fontSize=50,u.lineHeight=50,s.addComponent(cc.LabelOutline).color=cc.Color.BLACK,s.getComponent(cc.LabelOutline).width=4,u.string=e,(l=a.addComponent(cc.Layout)).resizeMode=cc.Layout.ResizeMode.NONE,l.paddingLeft=30,l.paddingRight=30,l.paddingTop=25,l.paddingBottom=20,(f=a.addComponent(cc.Sprite)).type=cc.Sprite.Type.SLICED,f.spriteFrame=c,a.addChild(s),n.node.addChild(a),p=cc.callFunc(function(){cc.tween(a).to(.3,{opacity:255}).start()}),h=cc.callFunc(function(){var e=setTimeout(function(){a.destroy(),clearTimeout(e)},t)},this),d=cc.sequence(p,h),a.runAction(d),[2]}})})},cc._RF.pop()},{"../manager/resources":"resources"}],"typed-event":[function(e,t,n){"use strict";cc._RF.push(t,"3455cEfP7NFLoL+iGdgHa17","typed-event"),Object.defineProperty(n,"__esModule",{value:!0}),n.TypedEvent=void 0;var o=function(){function e(){var e=this;this.listeners=[],this.listenersOnce=[],this.on=function(t){return e.listeners.push(t),{dispose:function(){return e.off(t)}}},this.once=function(t){e.listenersOnce.push(t)},this.off=function(t){var n=e.listeners.indexOf(t);n>-1&&e.listeners.splice(n,1)},this.emit=function(t){e.listeners.forEach(function(e){return e(t)}),e.listenersOnce.forEach(function(e){return e(t)}),e.listenersOnce=[]},this.pipe=function(t){return e.on(function(e){return t.emit(e)})}}return e.prototype.reset=function(){this.listeners=[]},e}();n.TypedEvent=o,cc._RF.pop()},{}],"ui-manager":[function(e,t,n){"use strict";cc._RF.push(t,"d42c6RD181OUoUo3aiLdgnY","ui-manager");var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{s(o.next(e))}catch(t){i(t)}}function a(e){try{s(o.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}s((o=o.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return s([e,t])}}function s(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.UI=void 0;var i=e("../components/base/base-layer"),c=e("../components/base/base-panel"),a=e("./layer-manager"),s=e("./panel-manager"),u=function(){function e(){}return e.openPanel=function(e,t,n){return o(this,void 0,Promise,function(){return r(this,function(){return[2,s.PanelManager.ins.open(e,t,n)]})})},e.openLayer=function(e,t){return o(this,void 0,Promise,function(){return r(this,function(){return[2,a.LayerManager.ins.open(e,t)]})})},e.getTopView=function(){var e=s.PanelManager.ins.panelList;if(e.length>0){var t=e[e.length-1];if(t.node)return t.node.getComponent(c.default)}var n=a.LayerManager.ins.layers;if(n.length>0)return n[n.length-1].getComponent(i.default)},e.getTopLayer=function(){var e=a.LayerManager.ins.layers;if(e.length>0)return e[e.length-1].getComponent(i.default)},e.getTopPanel=function(){var e=s.PanelManager.ins.panelList;if(e.length>0)return e[e.length-1].node},e.getPanelByName=function(e){for(var t=s.PanelManager.ins.panelList,n=0;n<t.length;++n)if(t[n].node.name==e)return t[n].node;return null},e}();n.UI=u,cc._RF.pop()},{"../components/base/base-layer":"base-layer","../components/base/base-panel":"base-panel","./layer-manager":"layer-manager","./panel-manager":"panel-manager"}],userdata:[function(e,t,n){"use strict";cc._RF.push(t,"f4398zebxtHw5d+AKiZt48o","userdata"),Object.defineProperty(n,"__esModule",{value:!0}),n.userData=void 0;var o=function(){function e(){this.settings={bgm:!0},this.proxy=new Proxy(this.settings,{set:function(e,t,n){return e[t]=n,console.log("Set "+String(t)+" to "+n),!0}}),this.load()}return e.prototype.save=function(){localStorage.setItem("user_settings",JSON.stringify(this.settings))},e.prototype.load=function(){var e=this,t=localStorage.getItem("user_settings");if(t){var n=JSON.parse(t);Object.keys(n).forEach(function(t){e.settings[t]=n[t]})}},e.prototype.getValue=function(e){return this.proxy[e]},e.prototype.setValue=function(e,t){this.proxy[e]=t,this.save()},e}(),r=function(){function e(){this.setting=new o,this.cards=[]}return e.prototype.load=function(){var e=localStorage.getItem("user_data");if(e){var t=JSON.parse(e);this.cards=t.cards}},e.prototype.save=function(){var e={cards:this.cards},t=JSON.stringify(e);localStorage.setItem("user_data",t)},e.prototype.loadDebug=function(){this.cards=[{id:1,level:1},{id:2,level:1},{id:1,level:2}]},e}();n.userData=new r,cc._RF.pop()},{}]},{},["Main","common","env","events","typed-event","index","locker","http","router","object-pool","sound","time","toast","base-layer","base-panel","card-deck","card","linked-prefab","prefab","game-layer","card-data-type","card-manager","layer-manager","panel-manager","resources","ui-manager","userdata"]);